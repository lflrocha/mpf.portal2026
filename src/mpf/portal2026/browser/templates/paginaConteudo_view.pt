<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master">

  <metal:css fill-slot="style_slot">

  </metal:css>

  <metal:main fill-slot="main">
    <div class="mpf-ui mpf-hub">

      <!-- Header -->
      <header class="mpf-hub__head" aria-labelledby="mpf-hub-title">
        <div class="mpf-hub__titlewrap">
          <h1 id="mpf-hub-title" class="mpf-hub__title"
              tal:content="context/Title">Título da página</h1>
          <p class="mpf-hub__subtitle"
             tal:condition="context/Description"
             tal:content="context/Description">
            Subtítulo da página se houver.
          </p>
        </div>

        <div class="mpf-hub__meta" aria-label="Informações da página">
          <span class="mpf-chip mpf-chip--muted">
            <span tal:content="python: context.modified().strftime('%d/%m/%Y')">00/00/0000</span>
          </span>
          <span class="mpf-chip mpf-chip--muted">Portal MPF</span>
        </div>
      </header>

            <!-- Lista -->
      <section class="mpf-card mpf-card--stack"
               tal:define="brains python: context.getFolderContents({'sort_on':'getObjPositionInParent'})">
        <header class="mpf-card__header mpf-card__header--row">
          <div>
            <h2 class="mpf-h2">Conteúdos</h2>
            <p class="mpf-sub">Arquivos, páginas, links e subpastas.</p>
          </div>
          <span class="mpf-chip mpf-chip--muted">
            <span tal:content="python: len(brains)">0</span> itens
          </span>
        </header>

        <div class="mpf-card__body">
          <!-- vazio -->
          <div class="mpf-empty" tal:condition="python: not brains">
            Nenhum conteúdo foi publicado nesta pasta ainda.
          </div>

          <ul class="mpf-hub-list" role="list" tal:condition="python: brains">
            <tal:block tal:repeat="b brains"
                       tal:define="
                          obj b/getObject;
                          ptype b/portal_type;
                          ctype python: (getattr(obj, 'contentType', None) or (obj.getContentType() if hasattr(obj,'getContentType') else ''));
                          is_folder python: ptype in ('Folder','Dexterity Folder','Large Plone Folder','ATFolder');
                          is_link python: ptype == 'Link';
                          is_pdf python: (ctype == 'application/pdf');
                          is_image python: (isinstance(ctype, str) and ctype.startswith('image/'));
                          is_file python: (ptype in ('File','Blob','ATFile')) or (ctype not in ('', None) and not is_image and not is_pdf and not is_link and not is_folder);
                          kind python: ('folder' if is_folder else ('link' if is_link else ('pdf' if is_pdf else ('image' if is_image else ('file' if is_file else 'page')))));
                          badge_text python: ('Pasta' if kind=='folder' else ('Link' if kind=='link' else ('PDF' if kind=='pdf' else ('Imagem' if kind=='image' else ('Arquivo' if kind=='file' else 'Página')))));
                       ">

              <li class="mpf-hub-item">
                <a tal:attributes="
                      href b/getURL;
                      class string:mpf-hub-card is-${kind};
                      target python:'_blank' if (kind=='pdf' or kind=='link') else None;
                      rel python:'noopener' if (kind=='pdf' or kind=='link') else None;
                    ">

                  <div class="mpf-hub-card__top">
                    <span tal:attributes="class python:
                          'mpf-badge mpf-badge--folder' if kind=='folder' else
                          ('mpf-badge mpf-badge--link' if kind=='link' else
                          ('mpf-badge mpf-badge--pdf' if kind=='pdf' else
                          ('mpf-badge mpf-badge--image' if kind=='image' else
                          ('mpf-badge mpf-badge--file' if kind=='file' else 'mpf-badge mpf-badge--page'))))"
                          tal:content="python: badge_text">
                      Tipo
                    </span>

                    <span class="mpf-meta"
                          tal:content="python: b.modified.strftime('%d/%m/%Y') if hasattr(b,'modified') else ''">
                      00/00/0000
                    </span>
                  </div>

                  <h3 class="mpf-hub-card__title" tal:content="b/Title">Nome do arquivo</h3>


                  <div class="mpf-hub-card__bottom">
                    <span class="mpf-cta"
                          tal:content="python:
                            'Abrir PDF ›' if kind=='pdf' else
                            ('Ir para a página ›' if kind=='link' else
                            ('Abrir pasta ›' if kind=='folder' else
                            ('Abrir imagem ›' if kind=='image' else
                            ('Baixar arquivo ›' if kind=='file' else 'Acessar página ›'))))">
                      Acessar ›
                    </span>
                  </div>

                </a>
              </li>

            </tal:block>
          </ul>
        </div>
      </section>

    </div>
  </metal:main>
</html>
